<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Cronograma de Emagrecimento com Vinagre de Maçã</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 18px 10px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-size: 0.95em;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .content {
            padding: 30px;
            min-height: 400px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .progress-section {
            background: #f0f4ff;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .progress-section h2 {
            margin-bottom: 15px;
            color: #333;
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .progress-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .progress-card h3 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            font-weight: normal;
        }

        .progress-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-top: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            min-width: 40px;
        }

        .week-section {
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }

        .week-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }

        .week-header h2 {
            font-size: 1.3em;
        }

        .week-body {
            padding: 20px;
            display: none;
            background: #fafafa;
        }

        .week-body.active {
            display: block;
        }

        .day-section {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .day-header {
            font-size: 1.1em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            margin-bottom: 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .checklist-item:hover {
            background: #e9ecef;
            transform: translateX(3px);
        }

        .checklist-item.completed {
            opacity: 0.65;
            background: #d4edda;
        }

        .checklist-item.completed label {
            text-decoration: line-through;
            color: #666;
        }

        .checklist-item input[type="checkbox"] {
            width: 22px;
            height: 22px;
            margin-right: 15px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .checklist-item label {
            flex: 1;
            cursor: pointer;
            font-size: 0.95em;
        }

        .checklist-item .time {
            color: #999;
            font-size: 0.85em;
            margin-left: 10px;
            white-space: nowrap;
        }

        .measurements-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .measurements-form h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .history-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        .history-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .history-table tr:hover {
            background: #f8f9fa;
        }

        .history-table tr:last-child td {
            border-bottom: none;
        }

        .export-section {
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .export-section h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .export-section p {
            margin-bottom: 20px;
            color: #666;
            line-height: 1.6;
        }

        .arrow {
            transition: transform 0.3s;
            font-size: 1.2em;
        }

        .arrow.rotated {
            transform: rotate(180deg);
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5em;
            }
            
            .progress-grid {
                grid-template-columns: 1fr;
            }

            .tab {
                font-size: 0.85em;
                padding: 15px 8px;
            }

            .content {
                padding: 20px;
            }

            .checklist-item {
                flex-wrap: wrap;
            }

            .checklist-item .time {
                width: 100%;
                margin-left: 37px;
                margin-top: 5px;
            }
        }

        @media print {
            body {
                background: white;
            }
            
            .tabs, .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🍎 Cronograma de Emagrecimento</h1>
            <p>Acompanhe seu progresso com vinagre de maçã</p>
        </header>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('checklist', event)">📋 Checklist</div>
            <div class="tab" onclick="switchTab('progress', event)">📊 Progresso</div>
            <div class="tab" onclick="switchTab('measurements', event)">📏 Medições</div>
            <div class="tab" onclick="switchTab('export', event)">💾 Exportar</div>
        </div>

        <div class="content">
            <div id="checklist" class="tab-content active">
                <div class="progress-section">
                    <h2>Progresso Geral</h2>
                    <div class="progress-bar">
                        <div class="progress-fill" id="totalProgress">0%</div>
                    </div>
                </div>
                <div id="weekContainer"></div>
            </div>

            <div id="progress" class="tab-content">
                <div class="progress-grid">
                    <div class="progress-card">
                        <h3>Dias Consecutivos</h3>
                        <div class="value" id="streakDays">0</div>
                    </div>
                    <div class="progress-card">
                        <h3>Progresso Total</h3>
                        <div class="value" id="totalCompleted">0%</div>
                    </div>
                    <div class="progress-card">
                        <h3>Tarefas Concluídas</h3>
                        <div class="value" id="tasksCompleted">0/0</div>
                    </div>
                    <div class="progress-card">
                        <h3>Semana Atual</h3>
                        <div class="value" id="currentWeek">1</div>
                    </div>
                </div>

                <div class="alert alert-info" style="margin-top: 30px;">
                    <strong>💡 Dica:</strong> Mantenha a consistência! Marque suas tarefas diariamente para melhorar seus resultados.
                </div>
            </div>

            <div id="measurements" class="tab-content">
                <div class="measurements-form">
                    <h2>Registrar Medições</h2>
                    <div class="form-group">
                        <label for="measureDate">Data</label>
                        <input type="date" id="measureDate">
                    </div>
                    <div class="form-group">
                        <label for="weight">Peso (kg)</label>
                        <input type="number" step="0.1" id="weight" placeholder="Ex: 75.5">
                    </div>
                    <div class="form-group">
                        <label for="waist">Cintura (cm)</label>
                        <input type="number" step="0.5" id="waist" placeholder="Ex: 85">
                    </div>
                    <div class="form-group">
                        <label for="hips">Quadril (cm)</label>
                        <input type="number" step="0.5" id="hips" placeholder="Ex: 95">
                    </div>
                    <div class="form-group">
                        <label for="notes">Observações</label>
                        <input type="text" id="notes" placeholder="Como você se sentiu hoje?">
                    </div>
                    <button class="btn btn-primary" onclick="saveMeasurement()">💾 Salvar Medição</button>
                </div>

                <h3 style="margin-bottom: 15px;">Histórico de Medições</h3>
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Peso (kg)</th>
                            <th>Cintura (cm)</th>
                            <th>Quadril (cm)</th>
                            <th>Observações</th>
                        </tr>
                    </thead>
                    <tbody id="measurementsHistory">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #999;">Nenhuma medição registrada</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="export" class="tab-content">
                <div class="export-section">
                    <h3>📥 Exportar Dados</h3>
                    <p>Baixe seus dados em diferentes formatos para análise ou backup. Todos os arquivos são gerados localmente no seu navegador.</p>
                    
                    <button class="btn btn-success" onclick="exportToCSV()">📊 Exportar para CSV</button>
                    <button class="btn btn-primary" onclick="exportToJSON()">💾 Exportar para JSON</button>
                    <button class="btn btn-secondary" onclick="exportToPDF()">📄 Gerar Relatório HTML</button>
                </div>

                <div class="alert alert-info" style="margin-top: 20px;">
                    <strong>ℹ️ Sobre os formatos:</strong><br>
                    <strong>CSV:</strong> Abra no Excel ou Google Sheets<br>
                    <strong>JSON:</strong> Backup completo dos dados<br>
                    <strong>HTML:</strong> Relatório visual (abra e use Ctrl+P para salvar como PDF)
                </div>
            </div>
        </div>
    </div>

    <script>
        var programData = {
            weeks: [
                {
                    name: "Semana 1-2: Adaptação",
                    days: [
                        { name: "Segunda-feira", tasks: [
                            { id: "w1d1t1", text: "Beber água ao acordar", time: "7h00" },
                            { id: "w1d1t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "11h45" },
                            { id: "w1d1t3", text: "Almoço balanceado (mastigar devagar)", time: "12h00" },
                            { id: "w1d1t4", text: "Lanche saudável da tarde", time: "15h30" },
                            { id: "w1d1t5", text: "Jantar leve", time: "19h00" },
                            { id: "w1d1t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]},
                        { name: "Terça-feira", tasks: [
                            { id: "w1d2t1", text: "Beber água ao acordar", time: "7h00" },
                            { id: "w1d2t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "11h45" },
                            { id: "w1d2t3", text: "Almoço balanceado", time: "12h00" },
                            { id: "w1d2t4", text: "Caminhada de 30 minutos", time: "18h00" },
                            { id: "w1d2t5", text: "Jantar leve", time: "19h00" },
                            { id: "w1d2t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]},
                        { name: "Quarta-feira", tasks: [
                            { id: "w1d3t1", text: "Beber água ao acordar", time: "7h00" },
                            { id: "w1d3t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "11h45" },
                            { id: "w1d3t3", text: "Almoço balanceado", time: "12h00" },
                            { id: "w1d3t4", text: "Lanche saudável da tarde", time: "15h30" },
                            { id: "w1d3t5", text: "Jantar leve", time: "19h00" },
                            { id: "w1d3t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]},
                        { name: "Quinta-feira", tasks: [
                            { id: "w1d4t1", text: "Beber água ao acordar", time: "7h00" },
                            { id: "w1d4t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "11h45" },
                            { id: "w1d4t3", text: "Almoço balanceado", time: "12h00" },
                            { id: "w1d4t4", text: "Caminhada de 30 minutos", time: "18h00" },
                            { id: "w1d4t5", text: "Jantar leve", time: "19h00" },
                            { id: "w1d4t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]},
                        { name: "Sexta-feira", tasks: [
                            { id: "w1d5t1", text: "Beber água ao acordar", time: "7h00" },
                            { id: "w1d5t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "11h45" },
                            { id: "w1d5t3", text: "Almoço balanceado", time: "12h00" },
                            { id: "w1d5t4", text: "Caminhada de 30 minutos", time: "18h00" },
                            { id: "w1d5t5", text: "Jantar leve", time: "19h00" },
                            { id: "w1d5t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]},
                        { name: "Sábado", tasks: [
                            { id: "w1d6t1", text: "Beber água ao acordar", time: "8h00" },
                            { id: "w1d6t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "12h00" },
                            { id: "w1d6t3", text: "Almoço balanceado", time: "12h15" },
                            { id: "w1d6t4", text: "Atividade física leve", time: "16h00" },
                            { id: "w1d6t5", text: "Jantar leve", time: "19h30" },
                            { id: "w1d6t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]},
                        { name: "Domingo", tasks: [
                            { id: "w1d7t1", text: "Beber água ao acordar", time: "8h00" },
                            { id: "w1d7t2", text: "Vinagre de maçã antes do almoço (1 col)", time: "12h00" },
                            { id: "w1d7t3", text: "Almoço balanceado", time: "12h15" },
                            { id: "w1d7t4", text: "Planejamento da semana seguinte", time: "17h00" },
                            { id: "w1d7t5", text: "Jantar leve", time: "19h30" },
                            { id: "w1d7t6", text: "Atingir meta de 2L de água", time: "21h00" }
                        ]}
                    ]
                },
                {
                    name: "Semana 3-4: Intensificação",
                    days: [
                        { name: "Segunda-feira", tasks: [
                            { id: "w2d1t1", text: "Vinagre de maçã ao acordar (1 col)", time: "7h00" },
                            { id: "w2d1t2", text: "Café da manhã com chia/linhaça", time: "7h20" },
                            { id: "w2d1t3", text: "Vinagre de maçã antes do almoço", time: "11h45" },
                            { id: "w2d1t4", text: "Almoço com salada crua antes", time: "12h00" },
                            { id: "w2d1t5", text: "Caminhada de 40 minutos", time: "18h00" },
                            { id: "w2d1t6", text: "Jantar leve com mais vegetais", time: "19h00" },
                            { id: "w2d1t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]},
                        { name: "Terça-feira", tasks: [
                            { id: "w2d2t1", text: "Vinagre de maçã ao acordar (1 col)", time: "7h00" },
                            { id: "w2d2t2", text: "Café da manhã com chia/linhaça", time: "7h20" },
                            { id: "w2d2t3", text: "Vinagre de maçã antes do almoço", time: "11h45" },
                            { id: "w2d2t4", text: "Almoço com salada crua antes", time: "12h00" },
                            { id: "w2d2t5", text: "Exercícios de força leve", time: "18h00" },
                            { id: "w2d2t6", text: "Jantar leve com mais vegetais", time: "19h00" },
                            { id: "w2d2t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]},
                        { name: "Quarta-feira", tasks: [
                            { id: "w2d3t1", text: "Vinagre de maçã ao acordar (1 col)", time: "7h00" },
                            { id: "w2d3t2", text: "Café da manhã com chia/linhaça", time: "7h20" },
                            { id: "w2d3t3", text: "Vinagre de maçã antes do almoço", time: "11h45" },
                            { id: "w2d3t4", text: "Almoço com salada crua antes", time: "12h00" },
                            { id: "w2d3t5", text: "Caminhada de 40 minutos", time: "18h00" },
                            { id: "w2d3t6", text: "Jantar leve com mais vegetais", time: "19h00" },
                            { id: "w2d3t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]},
                        { name: "Quinta-feira", tasks: [
                            { id: "w2d4t1", text: "Vinagre de maçã ao acordar (1 col)", time: "7h00" },
                            { id: "w2d4t2", text: "Café da manhã com chia/linhaça", time: "7h20" },
                            { id: "w2d4t3", text: "Vinagre de maçã antes do almoço", time: "11h45" },
                            { id: "w2d4t4", text: "Almoço com salada crua antes", time: "12h00" },
                            { id: "w2d4t5", text: "Exercícios de força leve", time: "18h00" },
                            { id: "w2d4t6", text: "Jantar leve com mais vegetais", time: "19h00" },
                            { id: "w2d4t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]},
                        { name: "Sexta-feira", tasks: [
                            { id: "w2d5t1", text: "Vinagre de maçã ao acordar (1 col)", time: "7h00" },
                            { id: "w2d5t2", text: "Café da manhã com chia/linhaça", time: "7h20" },
                            { id: "w2d5t3", text: "Vinagre de maçã antes do almoço", time: "11h45" },
                            { id: "w2d5t4", text: "Almoço com salada crua antes", time: "12h00" },
                            { id: "w2d5t5", text: "Caminhada de 40 minutos", time: "18h00" },
                            { id: "w2d5t6", text: "Jantar leve com mais vegetais", time: "19h00" },
                            { id: "w2d5t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]},
                        { name: "Sábado", tasks: [
                            { id: "w2d6t1", text: "Vinagre de maçã ao acordar (1 col)", time: "8h00" },
                            { id: "w2d6t2", text: "Café da manhã com chia/linhaça", time: "8h20" },
                            { id: "w2d6t3", text: "Vinagre de maçã antes do almoço", time: "12h00" },
                            { id: "w2d6t4", text: "Almoço com salada crua antes", time: "12h15" },
                            { id: "w2d6t5", text: "Atividade física moderada", time: "16h00" },
                            { id: "w2d6t6", text: "Jantar leve com mais vegetais", time: "19h30" },
                            { id: "w2d6t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]},
                        { name: "Domingo", tasks: [
                            { id: "w2d7t1", text: "Vinagre de maçã ao acordar (1 col)", time: "8h00" },
                            { id: "w2d7t2", text: "Café da manhã com chia/linhaça", time: "8h20" },
                            { id: "w2d7t3", text: "Vinagre de maçã antes do almoço", time: "12h00" },
                            { id: "w2d7t4", text: "Almoço com salada crua antes", time: "12h15" },
                            { id: "w2d7t5", text: "Planejamento da semana seguinte", time: "17h00" },
                            { id: "w2d7t6", text: "Jantar leve com mais vegetais", time: "19h30" },
                            { id: "w2d7t7", text: "Atingir meta de 2.5L de água", time: "21h00" }
                        ]}
                    ]
                }
            ]
        };

        var completedTasks = {};
        var measurements = [];

        function init() {
            try {
                var saved = localStorage.getItem('completedTasks');
                if (saved) {
                    completedTasks = JSON.parse(saved);
                }
            } catch (e) {
                completedTasks = {};
            }
            
            try {
                var savedMeas = localStorage.getItem('measurements');
                if (savedMeas) {
                    measurements = JSON.parse(savedMeas);
                }
            } catch (e) {
                measurements = [];
            }
            
            renderWeeks();
            updateAllProgress();
            renderMeasurements();
            
            var today = new Date();
            var dd = String(today.getDate()).padStart(2, '0');
            var mm = String(today.getMonth() + 1).padStart(2, '0');
            var yyyy = today.getFullYear();
            var todayStr = yyyy + '-' + mm + '-' + dd;
            
            var dateInput = document.getElementById('measureDate');
            if (dateInput) {
                dateInput.value = todayStr;
            }
        }

        function renderWeeks() {
            var container = document.getElementById('weekContainer');
            if (!container) return;
            
            container.innerHTML = '';

            for (var w = 0; w < programData.weeks.length; w++) {
                var week = programData.weeks[w];
                
                var weekDiv = document.createElement('div');
                weekDiv.className = 'week-section';
                
                var header = document.createElement('div');
                header.className = 'week-header';
                header.innerHTML = '<h2>' + week.name + '</h2><span class="arrow">▼</span>';
                header.setAttribute('data-week-index', w);
                header.onclick = function() {
                    var body = this.nextElementSibling;
                    var arrow = this.querySelector('.arrow');
                    if (body.classList.contains('active')) {
                        body.classList.remove('active');
                        arrow.classList.remove('rotated');
                    } else {
                        body.classList.add('active');
                        arrow.classList.add('rotated');
                    }
                };

                var body = document.createElement('div');
                body.className = 'week-body';
                if (w === 0) {
                    body.classList.add('active');
                }

                for (var d = 0; d < week.days.length; d++) {
                    var day = week.days[d];
                    
                    var dayDiv = document.createElement('div');
                    dayDiv.className = 'day-section';
                    
                    var dayHeader = document.createElement('div');
                    dayHeader.className = 'day-header';
                    dayHeader.textContent = day.name;
                    dayDiv.appendChild(dayHeader);

                    for (var t = 0; t < day.tasks.length; t++) {
                        var task = day.tasks[t];
                        var isCompleted = completedTasks[task.id];
                        
                        var taskDiv = document.createElement('div');
                        taskDiv.className = 'checklist-item';
                        if (isCompleted) {
                            taskDiv.classList.add('completed');
                        }
                        
                        var checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.checked = isCompleted ? true : false;
                        checkbox.setAttribute('data-task-id', task.id);
                        checkbox.onchange = function() {
                            var taskId = this.getAttribute('data-task-id');
                            toggleTask(taskId);
                        };
                        
                        var label = document.createElement('label');
                        label.textContent = task.text;
                        label.setAttribute('data-task-id', task.id);
                        label.onclick = function() {
                            var taskId = this.getAttribute('data-task-id');
                            toggleTask(taskId);
                        };
                        
                        var time = document.createElement('span');
                        time.className = 'time';
                        time.textContent = task.time;
                        
                        taskDiv.appendChild(checkbox);
                        taskDiv.appendChild(label);
                        taskDiv.appendChild(time);
                        dayDiv.appendChild(taskDiv);
                    }

                    body.appendChild(dayDiv);
                }

                weekDiv.appendChild(header);
                weekDiv.appendChild(body);
                container.appendChild(weekDiv);
            }
        }

        function toggleTask(taskId) {
            if (completedTasks[taskId]) {
                delete completedTasks[taskId];
            } else {
                completedTasks[taskId] = new Date().toISOString();
            }
            
            try {
                localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
            } catch (e) {
                console.error('Erro ao salvar:', e);
            }
            
            renderWeeks();
            updateAllProgress();
        }

        function updateAllProgress() {
            var totalTasks = 0;
            for (var w = 0; w < programData.weeks.length; w++) {
                var week = programData.weeks[w];
                for (var d = 0; d < week.days.length; d++) {
                    totalTasks += week.days[d].tasks.length;
                }
            }

            var completed = Object.keys(completedTasks).length;
            var percentage = totalTasks > 0 ? Math.round((completed / totalTasks) * 100) : 0;

            var progressFill = document.getElementById('totalProgress');
            if (progressFill) {
                progressFill.style.width = percentage + '%';
                progressFill.textContent = percentage + '%';
            }
            
            var totalCompletedEl = document.getElementById('totalCompleted');
            if (totalCompletedEl) {
                totalCompletedEl.textContent = percentage + '%';
            }
            
            var tasksCompletedEl = document.getElementById('tasksCompleted');
            if (tasksCompletedEl) {
                tasksCompletedEl.textContent = completed + '/' + totalTasks;
            }

            var dates = [];
            for (var key in completedTasks) {
                if (completedTasks.hasOwnProperty(key)) {
                    var dateStr = new Date(completedTasks[key]).toDateString();
                    if (dates.indexOf(dateStr) === -1) {
                        dates.push(dateStr);
                    }
                }
            }
            
            dates.sort(function(a, b) {
                return new Date(b) - new Date(a);
            });
            
            var streak = 0;
            if (dates.length > 0) {
                streak = 1;
                var oneDay = 24 * 60 * 60 * 1000;
                for (var i = 0; i < dates.length - 1; i++) {
                    var diff = (new Date(dates[i]) - new Date(dates[i + 1])) / oneDay;
                    if (diff <= 1) {
                        streak++;
                    } else {
                        break;
                    }
                }
            }
            
            var streakEl = document.getElementById('streakDays');
            if (streakEl) {
                streakEl.textContent = streak;
            }

            var startDate = measurements.length > 0 ? new Date(measurements[0].date) : new Date();
            var diffDays = Math.ceil((new Date() - startDate) / (1000 * 60 * 60 * 24));
            var currentWeek = Math.ceil(diffDays / 7);
            
            var weekEl = document.getElementById('currentWeek');
            if (weekEl) {
                weekEl.textContent = currentWeek;
            }
        }

        function saveMeasurement() {
            var date = document.getElementById('measureDate').value;
            var weight = document.getElementById('weight').value;
            var waist = document.getElementById('waist').value;
            var hips = document.getElementById('hips').value;
            var notes = document.getElementById('notes').value;

            if (!date) {
                alert('Por favor, selecione uma data');
                return;
            }

            var measurement = {
                date: date,
                weight: weight,
                waist: waist,
                hips: hips,
                notes: notes
            };
            
            measurements.push(measurement);
            
            try {
                localStorage.setItem('measurements', JSON.stringify(measurements));
            } catch (e) {
                alert('Erro ao salvar medição');
                return;
            }

            document.getElementById('weight').value = '';
            document.getElementById('waist').value = '';
            document.getElementById('hips').value = '';
            document.getElementById('notes').value = '';

            renderMeasurements();
            updateAllProgress();
            alert('Medição salva com sucesso!');
        }

        function renderMeasurements() {
            var tbody = document.getElementById('measurementsHistory');
            if (!tbody) return;
            
            if (measurements.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #999;">Nenhuma medição registrada</td></tr>';
                return;
            }

            var html = '';
            for (var i = measurements.length - 1; i >= 0; i--) {
                var m = measurements[i];
                var date = new Date(m.date);
                var dateStr = date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear();
                
                html += '<tr>';
                html += '<td>' + dateStr + '</td>';
                html += '<td>' + (m.weight || '-') + '</td>';
                html += '<td>' + (m.waist || '-') + '</td>';
                html += '<td>' + (m.hips || '-') + '</td>';
                html += '<td>' + (m.notes || '-') + '</td>';
                html += '</tr>';
            }
            
            tbody.innerHTML = html;
        }

        function switchTab(tabName, event) {
            var tabs = document.querySelectorAll('.tab');
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            var contents = document.querySelectorAll('.tab-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            var tabContent = document.getElementById(tabName);
            if (tabContent) {
                tabContent.classList.add('active');
            }

            if (tabName === 'progress') {
                updateAllProgress();
            }
        }

        function exportToCSV() {
            var csv = 'MEDICOES\n';
            csv += 'Data,Peso (kg),Cintura (cm),Quadril (cm),Observacoes\n';
            
            for (var i = 0; i < measurements.length; i++) {
                var m = measurements[i];
                csv += m.date + ',';
                csv += (m.weight || '') + ',';
                csv += (m.waist || '') + ',';
                csv += (m.hips || '') + ',';
                csv += '"' + (m.notes || '') + '"\n';
            }

            csv += '\n\nTAREFAS CONCLUIDAS\n';
            csv += 'ID,Data de Conclusao\n';
            
            for (var key in completedTasks) {
                if (completedTasks.hasOwnProperty(key)) {
                    var date = new Date(completedTasks[key]);
                    var dateStr = date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear();
                    csv += key + ',' + dateStr + '\n';
                }
            }

            downloadFile(csv, 'cronograma_emagrecimento.csv', 'text/csv');
            alert('Arquivo CSV baixado com sucesso!');
        }

        function exportToJSON() {
            var data = {
                exportDate: new Date().toISOString(),
                completedTasks: completedTasks,
                measurements: measurements,
                summary: {
                    totalTasksCompleted: Object.keys(completedTasks).length,
                    totalMeasurements: measurements.length
                }
            };

            var json = JSON.stringify(data, null, 2);
            downloadFile(json, 'cronograma_emagrecimento.json', 'application/json');
            alert('Arquivo JSON baixado com sucesso!');
        }

        function exportToPDF() {
            var totalTasks = 0;
            for (var w = 0; w < programData.weeks.length; w++) {
                for (var d = 0; d < programData.weeks[w].days.length; d++) {
                    totalTasks += programData.weeks[w].days[d].tasks.length;
                }
            }

            var completed = Object.keys(completedTasks).length;
            var percentage = Math.round((completed / totalTasks) * 100);
            
            var now = new Date();
            var dateStr = now.getDate() + '/' + (now.getMonth() + 1) + '/' + now.getFullYear();
            var timeStr = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();

            var html = '<!DOCTYPE html>\n';
            html += '<html lang="pt-BR">\n<head>\n';
            html += '<meta charset="UTF-8">\n';
            html += '<title>Relatório de Emagrecimento</title>\n';
            html += '<style>\n';
            html += 'body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }\n';
            html += 'h1 { color: #667eea; text-align: center; border-bottom: 3px solid #667eea; padding-bottom: 20px; }\n';
            html += 'h2 { color: #764ba2; margin-top: 30px; }\n';
            html += '.summary { background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; }\n';
            html += '.summary-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #ddd; }\n';
            html += 'table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n';
            html += 'th { background: #667eea; color: white; padding: 12px; text-align: left; }\n';
            html += 'td { padding: 10px; border-bottom: 1px solid #ddd; }\n';
            html += '.progress-bar { width: 100%; height: 30px; background: #e0e0e0; border-radius: 15px; margin: 10px 0; }\n';
            html += '.progress-fill { height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 15px; text-align: center; line-height: 30px; color: white; font-weight: bold; }\n';
            html += '</style>\n</head>\n<body>\n';
            
            html += '<h1>📊 Relatório de Progresso</h1>\n';
            html += '<p style="text-align: center; color: #666;">Gerado em: ' + dateStr + ' às ' + timeStr + '</p>\n';

            html += '<div class="summary">\n<h2>Resumo Geral</h2>\n';
            html += '<div class="summary-item"><strong>Progresso Total:</strong><span>' + percentage + '%</span></div>\n';
            html += '<div class="progress-bar"><div class="progress-fill" style="width: ' + percentage + '%">' + percentage + '%</div></div>\n';
            html += '<div class="summary-item"><strong>Tarefas Concluídas:</strong><span>' + completed + ' de ' + totalTasks + '</span></div>\n';
            html += '<div class="summary-item"><strong>Medições Registradas:</strong><span>' + measurements.length + '</span></div>\n';
            html += '</div>\n';

            html += '<h2>📏 Histórico de Medições</h2>\n';
            html += '<table>\n<thead>\n<tr>\n';
            html += '<th>Data</th><th>Peso (kg)</th><th>Cintura (cm)</th><th>Quadril (cm)</th><th>Observações</th>\n';
            html += '</tr>\n</thead>\n<tbody>\n';

            if (measurements.length === 0) {
                html += '<tr><td colspan="5" style="text-align: center;">Nenhuma medição registrada</td></tr>\n';
            } else {
                for (var i = 0; i < measurements.length; i++) {
                    var m = measurements[i];
                    var date = new Date(m.date);
                    var dStr = date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear();
                    
                    html += '<tr>\n';
                    html += '<td>' + dStr + '</td>\n';
                    html += '<td>' + (m.weight || '-') + '</td>\n';
                    html += '<td>' + (m.waist || '-') + '</td>\n';
                    html += '<td>' + (m.hips || '-') + '</td>\n';
                    html += '<td>' + (m.notes || '-') + '</td>\n';
                    html += '</tr>\n';
                }

                if (measurements.length > 1) {
                    var first = measurements[0];
                    var last = measurements[measurements.length - 1];
                    var weightDiff = null;
                    var waistDiff = null;
                    
                    if (first.weight && last.weight) {
                        weightDiff = (parseFloat(last.weight) - parseFloat(first.weight)).toFixed(1);
                    }
                    if (first.waist && last.waist) {
                        waistDiff = (parseFloat(last.waist) - parseFloat(first.waist)).toFixed(1);
                    }

                    html += '<tr style="background: #e8f5e9; font-weight: bold;">\n';
                    html += '<td>Evolução Total</td>\n';
                    html += '<td>' + (weightDiff ? (weightDiff > 0 ? '+' : '') + weightDiff + ' kg' : '-') + '</td>\n';
                    html += '<td>' + (waistDiff ? (waistDiff > 0 ? '+' : '') + waistDiff + ' cm' : '-') + '</td>\n';
                    html += '<td>-</td><td>-</td>\n';
                    html += '</tr>\n';
                }
            }

            html += '</tbody>\n</table>\n';

            html += '<h2>💡 Recomendações</h2>\n';
            html += '<div class="summary">\n<ul>\n';
            
            if (percentage >= 70) {
                html += '<li>✅ Excelente aderência! Continue assim!</li>\n';
            } else {
                html += '<li>⚠️ Tente aumentar a consistência nas tarefas</li>\n';
            }
            
            if (measurements.length >= 3) {
                html += '<li>✅ Bom acompanhamento das medições</li>\n';
            } else {
                html += '<li>⚠️ Registre suas medições semanalmente</li>\n';
            }
            
            html += '<li>Continue seguindo o cronograma estabelecido</li>\n';
            html += '<li>Mantenha-se hidratado</li>\n';
            html += '<li>Consulte um profissional de saúde para orientação personalizada</li>\n';
            html += '</ul>\n</div>\n';

            html += '</body>\n</html>';

            downloadFile(html, 'relatorio_emagrecimento.html', 'text/html');
            alert('Relatório HTML gerado! Abra o arquivo e use Ctrl+P (Cmd+P no Mac) para salvar como PDF.');
        }

        function downloadFile(content, filename, type) {
            var blob = new Blob([content], { type: type });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            
            setTimeout(function() {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>